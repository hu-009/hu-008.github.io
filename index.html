<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>想跑？不可能的～</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  :root{ --pink:#ff85a2; --deep:#e91e63}
  body{
    margin:0;height:100vh;background:linear-gradient(135deg,#ffe3f3 0%,#ffc2d9 100%);
    display:flex;align-items:center;justify-content:center;
    font-family:"微软雅黑",sans-serif;text-align:center;
  }
  .box{background:rgba(255,255,255,.85);padding:50px 70px;border-radius:20px;box-shadow:0 8px 30px rgba(0,0,0,.15)}
  h1{color:var(--deep);font-size:2.6em;margin:0 0 20px}
  p{font-size:1.2em;color:#555}
  button{margin:15px 8px;padding:12px 28px;border:none;border-radius:25px;font-size:16px;cursor:pointer;transition:.3s}
  .fake{background:var(--pink);color:#fff}
  .real{background:#fff;color:var(--pink);border:2px solid var(--pink)}
  #countBar{width:100%;height:8px;background:#ffe3f3;border-radius:4px;margin:20px 0;overflow:hidden}
  #countBar div{height:100%;background:var(--deep);width:100%;transition:width 1s linear}
</style>
</head>
<body>
<div class="box">
  <h1>小薇宝宝，想溜？</h1>
  <p id="subtitle">先完成小任务才能走哦～</p >
  <div id="countBar"><div id="bar"></div></div>
  <button class="fake" onclick="branchStory()">我要退出</button>
  <button class="real" onclick="realQuit()">亲我一下再退出</button>
</div>

<script>
/* ===== 拦截关闭 ===== */
window.onbeforeunload = e => {
  e.returnValue = "真的要走嘛～";
  return "真的要走嘛～";
};

/* ===== 分支剧情 ===== */
function branchStory(){
  let kisses = 0;
  const max = 3;
  const ask = _ => {
    if(kisses < max){
      if(confirm(`亲我一下嘛~（${max-kisses}/${max}）`)){
        kisses++;
        ask();
      }
    }else{
      alert("好好好，给你真·退出按钮！");
      document.querySelector('.real').style.display = 'inline-block';
    }
  };
  ask();
}

/* ===== 倒计时+真放行 ===== */
function realQuit(){
  let t = 5;
  const sub = document.getElementById('subtitle');
  const bar = document.getElementById('bar');
  const tick = setInterval(()=>{
    sub.textContent = `爱的冷却中… ${t}s`;
    bar.style.width = (t/5*100)+'%';
    if(--t < 0){
      clearInterval(tick);
      window.onbeforeunload = null;
      window.close();
      setTimeout(()=>{ location.href='https://www.bilibili.com'; },300);
    }
  },1000);
}
</script>
</body>
</html>
